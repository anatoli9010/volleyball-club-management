{% extends 'base.html' %}{% block content %}
<h3>Турнири</h3>
<div class="row">
  <div class="col-md-5">
    <div class="card mb-3"><div class="card-body">
      <h5 class="card-title">Нов турнир</h5>
      <form method="post" action="{{ url_for('tournaments') }}">
        <input class="form-control mb-2" name="name" placeholder="Име" required>
        <div class="row g-2">
          <div class="col"><input class="form-control" type="date" name="start_date" placeholder="Начало"></div>
          <div class="col"><input class="form-control" type="date" name="end_date" placeholder="Край"></div>
        </div>
        <input class="form-control my-2" name="venue" placeholder="Локация (зала/град)">
        <textarea class="form-control mb-2" name="notes" placeholder="Бележки (резултати, класиране, точки)"></textarea>
        <label class="form-label">Отбори</label>
        <select class="form-select" name="team_ids" multiple size="6">
          {% for t in teams %}<option value="{{ t.id }}">{{ t.name }}</option>{% endfor %}
        </select>
        <button class="btn btn-success mt-2">Добави</button>
      </form>
    </div></div>
  </div>
  <div class="col-md-7">
    <div class="card mb-3"><div class="card-body">
      <div class="d-flex justify-content-between align-items-center">
        <h5 class="card-title mb-0">Списък</h5>
        <a class="btn btn-sm btn-outline-primary" href="{{ url_for('export_tournaments_excel') }}">Експорт в Excel</a>
      </div>
      <table class="table table-sm">
        <thead><tr><th>Име</th><th>Дати</th><th>Локация</th><th>Отбори</th><th>Бележки/Резултати</th><th></th></tr></thead>
        <tbody>
          {% for r in tournaments %}
          <tr>
            <td>{{ r.t.name }}</td>
            <td>{% if r.t.start_date %}{{ r.t.start_date.strftime('%d.%m.%Y') }}{% endif %}{% if r.t.end_date %} - {{ r.t.end_date.strftime('%d.%m.%Y') }}{% endif %}</td>
            <td>{{ r.t.venue }}</td>
            <td>{{ ', '.join(r.teams) }}</td>
            <td>{{ r.t.notes }}</td>
            <td>
              <form method="post" action="{{ url_for('delete_tournament', t_id=r.t.id) }}" onsubmit="return confirm('Изтриване?');">
                <button class="btn btn-danger btn-sm">Изтрий</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div></div>
  </div>
</div>
{% endblock %}

