{% extends 'base.html' %}{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h3>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h3>
  <div class="d-flex align-items-center">
    <form class="row g-2" method="get">
      <div class="col-auto"><input class="form-control" name="month" value="{{ '%02d'|format(month) if month else '' }}" placeholder="–ú–µ—Å–µ—Ü"></div>
      <div class="col-auto"><input class="form-control" name="year" value="{{ year if year else '' }}" placeholder="–ì–æ–¥–∏–Ω–∞"></div>
      <div class="col-auto">
        <select class="form-select" name="team_id">
          <option value="">–í—Å–∏—á–∫–∏ –æ—Ç–±–æ—Ä–∏</option>
          {% for t in teams %}
            <option value="{{ t.id }}" {% if selected_team_id and selected_team_id==t.id %}selected{% endif %}>{{ t.name }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-auto"><button class="btn btn-outline-secondary">–§–∏–ª—Ç—ä—Ä</button></div>
    </form>
    {% if current_user.role == 'admin' %}
      <form class="ms-2" method="post" action="{{ url_for('admin_materialize_month') }}" onsubmit="return confirm('–ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ –≤—Å–∏—á–∫–∏ —Å–ª–æ—Ç–æ–≤–µ –∑–∞ –∏–∑–±—Ä–∞–Ω–∏—è –º–µ—Å–µ—Ü?');">
        <input type="hidden" name="month" value="{{ month }}">
        <input type="hidden" name="year" value="{{ year }}">
        <button class="btn btn-outline-primary">–ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∏—Ä–∞–π –º–µ—Å–µ—Ü–∞</button>
      </form>
      <form class="ms-2" method="post" action="{{ url_for('delete_all_trainings') }}" onsubmit="return confirm('–ù–∞–∏—Å—Ç–∏–Ω–∞ –ª–∏ –¥–∞ –∏–∑—Ç—Ä–∏–µ–º –≤—Å–∏—á–∫–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏?');">
        <button class="btn btn-outline-danger">üóëÔ∏è –ò–∑—Ç—Ä–∏–π –≤—Å–∏—á–∫–∏</button>
      </form>
    {% endif %}
    <a class="btn btn-success ms-2" href="{{ url_for('add_training') }}">‚ûï –î–æ–±–∞–≤–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</a>
  </div>
</div>
<table class="table">
  <thead><tr><th>–î–∞—Ç–∞</th><th>–û—Ç–±–æ—Ä</th><th>–ß–∞—Å</th><th>–ó–∞–ª–∞/–ë–µ–ª–µ–∂–∫–∏</th><th class="text-end">–î–µ–π—Å—Ç–≤–∏—è</th></tr></thead>
  <tbody>
    {% for tr in trainings %}
    <tr>
      <td>{{ tr.date.strftime('%d.%m.%Y') }}</td>
      <td>
        {% if tr.session_team %}
          <span style="color: {{ team_color(tr.session_team.name) }}; font-weight:600">{{ tr.session_team.name }}</span>
        {% else %}‚Äî{% endif %}
      </td>
      <td>{{ tr.start_time or '-' }} - {{ tr.end_time or '-' }}</td>
      <td>{{ tr.notes or '' }}</td>
      <td class="text-end">
        <a class="btn btn-sm btn-primary" href="{{ url_for('attendance_form', training_id=tr.id) }}">–û—Ç–±–µ–ª–µ–∂–∏</a>
        <form method="post" action="{{ url_for('delete_training', training_id=tr.id) }}" onsubmit="return confirm('–ò–∑—Ç—Ä–∏–≤–∞–Ω–µ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞—Ç–∞?');" style="display:inline">
          <button class="btn btn-sm btn-outline-danger">–ò–∑—Ç—Ä–∏–π</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
  {% if trainings|length == 0 %}
  <tfoot>
    <tr><td colspan="5" class="text-center text-muted">–ù—è–º–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∑–∞ –∏–∑–±—Ä–∞–Ω–∏—è –ø–µ—Ä–∏–æ–¥.</td></tr>
  </tfoot>
  {% endif %}
</table>
{% endblock %}